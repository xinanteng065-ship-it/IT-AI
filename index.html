<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ITトレンド診断</title>
<style>
/* 全体 */
body {
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(to bottom, #f5f7fa, #e0ebff);
  color: #333;
  padding: 20px;
  max-width: 700px;
  margin: auto;
}

/* タイトル */
h1 {
  text-align: center;
  color: #2a5db0;
  margin-bottom: 30px;
}

/* 進捗バー */
#progress-container {
  width: 100%;
  background: #ddd;
  border-radius: 8px;
  margin-bottom: 10px;
  height: 14px;
  overflow: hidden;
}
#progress-bar {
  height: 100%;
  width: 0%;
  background: #4cafef;
  border-radius: 8px;
  transition: width 0.3s;
}

/* 質問番号表示 */
#question-number {
  text-align: right;
  font-size: 14px;
  color: #555;
  margin-bottom: 10px;
}

/* カードスタイル */
.quiz-card, .result-card {
  background: #fff;
  padding: 30px;
  border-radius: 15px;
  box-shadow: 0 6px 25px rgba(0,0,0,0.1);
  margin-bottom: 20px;
  transition: transform 0.2s;
}
.quiz-card:hover {
  transform: translateY(-2px);
}

/* 問題タイトル */
.quiz-card h3 {
  margin-bottom: 20px;
  color: #1a3a7e;
}

/* 選択ボタン */
.quiz-card button, #back-button {
  width: 100%;
  padding: 14px;
  margin: 8px 0;
  border-radius: 10px;
  border: none;
  background: #4cafef;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
  transition: 0.2s;
}
.quiz-card button:hover, #back-button:hover {
  background: #2196f3;
}

/* 戻るボタン */
#back-button {
  background: #aaa;
  margin-top: 10px;
}
#back-button:hover {
  background: #888;
}

/* 結果カード */
.result-card h2 {
  color: #2a5db0;
  margin-bottom: 15px;
}
.result-card pre {
  white-space: pre-wrap;
  font-size: 15px;
}
</style>
</head>
<body>

<h1>AIによるITトレンド診断</h1>

<div id="progress-container"><div id="progress-bar"></div></div>
<div id="question-number"></div>
<div id="quiz-container"></div>
<div id="result-container" style="display:none;"></div>

<script>
const questions = [
"ITニュースをどこでよく見ますか？",
"興味を持つトピックは？",
"あなたのITスキルレベルは？",
"テクノロジーで一番重視するのは？",
"普段よく使うデバイスは？",
"チームで何を担当したいタイプ？",
"新しい技術が出たら？",
"将来やってみたいことは？",
"興味がある働き方は？",
"好きなタイプのITニュースは？"
];

const choices = [
["SNS","ニュースアプリ","YouTube","企業ブログ","見ない"],
["AI","Web3","セキュリティ","クラウド","開発"],
["初心者","少し触った","よく使う","専門的","教える側"],
["効率化","クリエイティブ","安全性","ビジネス","社会影響"],
["スマホ","ノートPC","デスクトップ","タブレット","IoT機器"],
["企画","開発","デザイン","分析","発信"],
["すぐ試す","様子見","必要なら調べる","気にしない","慎重派"],
["AIサービスを作る","副業したい","キャリアアップ","教育したい","趣味で楽しむ"],
["フリーランス","会社員","起業家","教育職","コンサル"],
["研究発表","新サービス","トレンドまとめ","事件系","市場動向"]
];

let current = 0;
let answers = [];
const quizContainer = document.getElementById("quiz-container");
const resultContainer = document.getElementById("result-container");
const progressBar = document.getElementById("progress-bar");
const questionNumber = document.getElementById("question-number");

function updateProgress() {
  progressBar.style.width = ((current/questions.length)*100) + "%";
  questionNumber.textContent = `質問 ${current+1}/${questions.length}`;
}

function showQuestion() {
  updateProgress();
  quizContainer.innerHTML = `
    <div class="quiz-card">
      <h3>Q${current+1}. ${questions[current]}</h3>
      ${choices[current].map((c,i)=>`<button onclick="selectAnswer('${c}')">${i+1}. ${c}</button>`).join("")}
      ${current>0?'<button id="back-button" onclick="goBack()">戻る</button>':''}
    </div>
  `;
}

function selectAnswer(choice) {
  answers[current] = choice;
  current++;
  if(current<questions.length){
    showQuestion();
  }else{
    submitAnswers();
  }
}

function goBack() {
  if(current>0){
    current--;
    showQuestion();
  }
}

async function submitAnswers() {
  quizContainer.style.display = "none";
  resultContainer.style.display = "block";
  resultContainer.innerHTML = `<div class="result-card"><p>AIが診断中です...⏳</p></div>`;

  try{
    const res = await fetch("http://localhost:3000/api/diagnosis", {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({answers})
    });
    const data = await res.json();
    resultContainer.innerHTML = `<div class="result-card"><h2>診断結果</h2><pre>${data.result}</pre></div>`;
  }catch(err){
    resultContainer.innerHTML = `<div class="result-card"><p>エラーが発生しました: ${err.message}</p></div>`;
  }
}

showQuestion();
</script>
</body>
</html>
